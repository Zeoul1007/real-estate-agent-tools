<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Estate Agent Tools</title>
    
    <!-- Bootstrap for Styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

    <style>
        /* Background Gradient */
        body {
            background: linear-gradient(to right, #b3e5fc, #e3f2fd); /* Light blue gradient */
            font-family: Arial, sans-serif;
        }

        /* Centered Content */
        .container {
            max-width: 600px;
            margin: auto;
            text-align: center;
            padding-top: 50px;
        }

        /* Box Styling */
        .box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px; /* Adds space between sections */
        }

        /* Custom Button Styling */
        .btn-custom {
            font-size: 18px;
            border-radius: 8px;
            padding: 10px;
            transition: 0.3s;
        }

        .btn-custom:hover {
            transform: scale(1.05);
            opacity: 0.9;
        }

        /* Space Between Buttons and Links */
        .response-links {
            margin-top: 15px;
        }

        /* Mobile-Friendly Adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            .btn-custom {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">Real Estate Agent Assistant</h1>

        <!-- Open RealEstate AI -->
        <div class="box">
            <h2>üí¨ Open RealEstate AI</h2>
            <p>Click below to chat with AI about market trends, reports, and more.</p>
            <a href="https://chatgpt.com/g/g-67b170b3c090819199488bbe27144ada-realestate-ai" target="_blank" class="btn btn-primary btn-custom">
                <i class="fas fa-robot"></i> Chat with AI
            </a>
        </div>

        <!-- Calendar Scheduling -->
        <div class="box">
            <h2>üìÖ Schedule an Appointment</h2>
            <input type="text" id="calendarEvent" class="form-control" placeholder="Enter event (e.g., Meeting with Tom at 2PM tomorrow)">
            <button class="btn btn-success btn-custom" onclick="scheduleEvent()">
                <i class="fas fa-calendar-plus"></i> Schedule
            </button>
            <p id="calendarResponse" class="response-links"></p>
        </div>

        <!-- Google Maps -->
        <div class="box">
            <h2>üìç Get Directions</h2>
            <input type="text" id="mapQuery" class="form-control" placeholder="Enter an address">
            <button class="btn btn-warning btn-custom" onclick="getDirections()">
                <i class="fas fa-map-marked-alt"></i> Get Directions
            </button>
            <p id="mapResponse" class="response-links"></p>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        function parseInput(input) {
            let title = "Event";
            let date = new Date();
            let time = "1200";
            let location = "";

            // Check if "tomorrow" is mentioned
            if (input.toLowerCase().includes("tomorrow")) {
                date.setDate(date.getDate() + 1);
            }

            // Extract time (supports 12-hour and 24-hour formats)
            const timeMatch = input.match(/\b(\d{1,2}(:\d{2})?\s?(AM|PM|am|pm)?\b/);
            if (timeMatch) {
                let extractedTime = timeMatch[0].toUpperCase();
                let hour = parseInt(extractedTime);
                const isPM = extractedTime.includes("PM");

                // Convert 12-hour format to 24-hour format
                if (isPM && hour < 12) {
                    hour += 12;
                } else if (!isPM && hour === 12) {
                    hour = 0; // 12 AM is 00:00 in 24-hour format
                }

                // Format time as HHMM
                time = `${hour.toString().padStart(2, "0")}00`;
            }

            // Extract location
            const locationMatch = input.match(/at\s(.*)/i);
            if (locationMatch) {
                location = locationMatch[1].trim();
                location = location.replace(/(tomorrow|at \d{1,2}(?::\d{2})?\s?(AM|PM|am|pm)?)/gi, "").trim();
            }

            // Extract title
            const titleMatch = input.match(/(meeting|showing|appointment)/i);
            if (titleMatch) {
                title = titleMatch[0].charAt(0).toUpperCase() + titleMatch[0].slice(1);
                const withMatch = input.match(/with\s([\w\s]+)/i);
                if (withMatch) {
                    title += " with " + withMatch[1].split(" at")[0].trim();
                }
            }

            return { title, date, time, location };
        }

        function generateGoogleCalendarLink(event) {
            const startTime = event.date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
            const endTime = new Date(event.date.getTime() + 3600000).toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';

            return `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(event.title)}&dates=${startTime}/${endTime}&location=${encodeURIComponent(event.location)}`;
        }

        function generateICSFile(event) {
            const startTime = event.date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
            const endTime = new Date(event.date.getTime() + 3600000).toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';

            const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Real Estate Assistant//EN
BEGIN:VEVENT
UID:${startTime}-001@realestateassistant.com
DTSTAMP:${new Date().toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z'}
DTSTART:${startTime}
DTEND:${endTime}
SUMMARY:${event.title}
LOCATION:${event.location}
DESCRIPTION:Created with Real Estate Assistant
END:VEVENT
END:VCALENDAR`;

            return `data:text/calendar;charset=utf-8,${encodeURIComponent(icsContent)}`;
        }

        function scheduleEvent() {
            const input = document.getElementById("calendarEvent").value;
            const responseBox = document.getElementById("calendarResponse");

            if (!input) {
                responseBox.innerHTML = `<p class="text-danger">‚ùå Please enter an event description.</p>`;
                return;
            }

            try {
                const event = parseInput(input);
                const googleLink = generateGoogleCalendarLink(event);
                const icsLink = generateICSFile(event);

                responseBox.innerHTML = `
                    <p>‚úÖ Event Created!</p>
                    <a href="${googleLink}" target="_blank">üìÖ Add to Google Calendar</a><br>
                    <a href="${icsLink}" download="event.ics">üçè Download for Apple Calendar</a>
                `;
            } catch (error) {
                responseBox.innerHTML = `<p class="text-danger">‚ùå Error: Could not create event. Please check your input.</p>`;
                console.error(error);
            }
        }

        function getDirections() {
            const address = document.getElementById("mapQuery").value;
            if (!address) {
                document.getElementById("mapResponse").innerHTML = `<p class="text-danger">‚ùå Please enter an address.</p>`;
                return;
            }

            const mapUrl = `https://www.google.com/maps?q=${encodeURIComponent(address)}`;
            document.getElementById("mapResponse").innerHTML = `<a href="${mapUrl}" target="_blank">üìç Open in Google Maps</a>`;
        }
    </script>
</body>
</html>
